<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>サンタさんの にこにこカレンダー</title>
    <link rel="stylesheet" href="./styles.css" />
</head>

<body>
    <header class="wrap">
        <div class="header-banner">
            <h1>サンタさんの にこにこカレンダー</h1>
            <p class="sub">2025/12/12〜12/24｜1にち2かいまで</p>
        </div>
        <div id="scoreBoard" class="score-board">
            <div class="score-item">きょう <span id="scoreToday">0</span>てん</div>
            <div class="score-item">ぜんぶ <span id="scoreTotal">0</span>てん</div>
        </div>
        <button id="resetBtn" class="btn">ぜんぶ けす</button>
        <button id="soundToggleBtn" class="btn" style="margin-left:8px;">♪ 音:ON</button>
        <div id="timerControls" style="display:inline-block; margin-left:8px;">
            <select id="timerPreset" class="btn" style="padding: 10px 4px; font-size:0.9rem;">
                <option value="300">5ふん</option>
                <option value="600" selected>10ぷん</option>
                <option value="900">15ふん</option>
            </select>
            <button id="timerStartBtn" class="btn"
                style="background:#ff9800; color:#fff; border:none; font-weight:bold;">スタート</button>
            <span style="font-size:0.8rem; margin-left:8px;">カスタム:</span>
            <input id="timerCustom" type="number" min="1" max="60" placeholder="ふん" class="btn"
                style="width:50px; padding:10px 4px; text-align:center;">

            <!-- Step 5: Sound Controls -->
            <div style="display:inline-flex; align-items:center; margin-left:10px; font-size:0.8rem;">
                <label style="cursor:pointer; margin-right:5px;">
                    <input type="checkbox" id="timerSoundToggle" checked> 音
                </label>
                <input type="range" id="timerVolume" min="0" max="100" value="50" style="width:60px;">
            </div>
        </div>
    </header>

    <div id="statusArea" class="wrap"
        style="text-align:right; margin-bottom:-10px; height:20px; font-size:0.8rem; color:#006400; font-weight:bold;">
        <!-- Streak & Save Status -->
        <span id="streakBadge" style="margin-right:12px; display:none;">🔥 0日連続！</span>
        <span id="forecastMsg" style="margin-right:12px; font-weight:normal; color:#555;"></span>
        <span id="saveStatus"></span>
    </div>

    <main class="wrap">
        <div id="sugorokuArea">
            <h2>サンタロード</h2>
            <div id="sugorokuBoard" class="board"></div>
        </div>
        <div id="days"></div>
    </main>

    <div id="authArea" class="wrap" style="margin-top: 24px; border-top: 1px solid #ddd; padding-top: 16px;">
        <div id="loginForm">
            <h3>ほごしゃメニュー</h3>
            <p style="font-size: 0.9em; color: #666;">メールアドレスを入力して、ログインリンクを受け取ってください。</p>
            <div style="display: flex; gap: 8px; max-width: 400px; margin-bottom: 8px;">
                <input type="email" id="emailInput" placeholder="email@example.com" class="input-text" />
                <button id="sendMagicLinkBtn" class="btn-primary">ログインリンク送信</button>
            </div>
            <div id="authMessage" style="font-size: 0.9em;"></div>
        </div>

        <div id="userInfo" style="display: none;">
            <h3>ログイン中</h3>
            <p>Email: <span id="userEmail"></span></p>
            <p style="font-size: 0.8em; color: #888;">ID: <span id="userId"></span></p>
            <button id="logoutBtn" class="btn">ログアウト</button>
        </div>
    </div>
    <div id="supabase-status" style="position: fixed; bottom: 5px; right: 5px; font-size: 10px; opacity: 0.7;">Supabase:
        connecting...</div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="./config.js"></script>
    <script src="./app.js"></script>
    <div id="bonusOverlay" class="bonus-overlay">
        <div>+1 ボーナス！</div>
        <div style="font-size: 3rem; margin-top:10px;">🎉</div>
    </div>

    <!-- Step 1: Timer Overlay Shell -->
    <div id="timerOverlay" class="timer-overlay" style="display:none;">
        <div class="timer-content">
            <div id="timerDisplay" class="timer-display">10:00</div>
            <div id="timerMessage" class="timer-message" style="display:none;">おしまい！</div>
            <div id="timerControlsOverlay" style="margin-top:20px;">
                <button id="timerOverlayStartBtn" class="btn timer-control-btn"
                    style="display:none; background:#ff9800; color:#fff;">スタート</button>
                <button id="timerPauseBtn" class="btn timer-control-btn"
                    style="display:none; background:#fbc02d; color:#fff;">いちじ ていし</button>
                <button id="timerResumeBtn" class="btn timer-control-btn"
                    style="display:none; background:#4caf50; color:#fff;">さいかい</button>
                <button id="timerResetBtn" class="btn timer-control-btn"
                    style="background:#ef5350; color:#fff; margin-left:10px;">リセット</button>
                <button id="timerStopSoundBtn" class="btn timer-control-btn timer-stop-btn"
                    style="display:none; background:#d32f2f; color:#fff; font-weight:bold;">音をとめる</button>
                <button id="timerStampBtn" class="btn timer-control-btn"
                    style="display:none; background:#4caf50; color:#fff; border:2px solid #fff; margin-left:10px; font-weight:bold;">スタンプをつける</button>
            </div>
            <button id="timerCloseBtn" class="timer-close-btn">×</button>
        </div>
    </div>
</body>

</html>